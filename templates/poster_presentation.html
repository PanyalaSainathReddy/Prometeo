{% extends 'template.html' %}
{% load static %}

{% block title %}
{{type|capfirst}} Events
{% endblock %}


{% block style %}
<!-- import css files or write css code-->
<link href="{% static 'css/poster_presentation.css' %}" rel="stylesheet">
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

{% endblock %}

{% block content %}
<section class="dark">
	<div class="container py-4">
        <div style="margin-top: 20px; margin-bottom: 30px; width:100%; background-attachment: fixed;align-items: center; 
        justify-content: center; display:flex">
            <div class="section-header">
                <h2>Poster Presentations</h2>
            </div>
        </div>
        {% if brochure %}
            <p data-aos="fade-in" data-aos-delay="500" data-aos-duration="500" data-aos-once = "true" style="font-size: x-large; color: white; text-align: center; margin-bottom: 40px"><a href="{{brochure.file.url}}" style="color: #2b2d2e;
                font-size: medium;
                background: #ffffff;
                padding: 10px;
                border-radius: 5px;
                border: 3px solid #47b2e4;"><i class="fas fa-download"></i> {{brochure.name}}</a></p>
        {% endif %}
        {% if events.count == 0 %}
            <p data-aos="fade-up" data-aos-delay="1000" data-aos-duration="1000" data-aos-once = "true" style="font-size: xx-large; color: white; text-align: center;">Coming Soon!</p>
        {% endif %}
        {% for event in events %}
        <article class="postcard dark blue" data-aos="fade-up">
            <div class="postcard__text">
                <h1 class="postcard__title blue">{{event.name}}</h1>
                {% if event.prize %}
                    <div class="postcard__subtitle small">
                        <time datetime="2020-05-25 12:00:00">
                            <!-- <i class="fas fa-calendar-alt mr-2"></i> -->
                            {{ event.prize }}
                        </time>
                    </div>
                {% endif %}
                <div class="postcard__bar"></div>
                <div class="postcard__preview-txt">{{event.description|safe}}</div>
                <ul class="postcard__tagbox">
                    {% if event.date|date:"N j, Y" == "Jan. 1, 2023" %}
                    <li class="tag__item"><i class="fas fa-calendar-alt mr-2"></i> Coming Soon</li>
                    {% else %}
                    <li class="tag__item"><i class="fas fa-calendar-alt mr-2"></i>  {{ event.date }} <b>|</b> {{event.time}}</li>
                    {% endif %}
                    {% if event.sample_poster %}
                    <a href="{{ event.sample_poster }}">
                        <li class="tag__item play blue" style="cursor: pointer;"><i class="fas fa-download mr-2"></i> Sample Poster</li>
                    </a>
                    {% endif %}
                    {% if event.presentation_template %}
                    <a href="{{ event.presentation_template }}">
                        <li class="tag__item play blue" style="cursor: pointer;"><i class="fas fa-download mr-2"></i> Presentation Template</li>
                    </a>
                    {% endif %}
                    <div>
                        {% if not event.submissions_started and event in users.extendeduser.events.all %}
                            <li class="tag__item"> Already Registered</li>
                        {% elif user in submittedUsers %}
                            <li class="tag__item"><i class="fas fa-check-circle mr-2"></i> Submitted</li>
                        {% elif event in user.extendeduser.events.all %}
                            <li class="tag__item play blue" data-bs-toggle="modal" data-bs-target="#staticBackdrop"><i class="fas fa-upload mr-2"></i> Upload</li>
                            <!-- Modal -->
                            <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Upload Your Submission</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <form method="post" action="{% url 'events:uploadSubmission' %}"  enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <div class="modal-body">
                                            <label for="fileUploaded">File </label>
                                            <input type="file" name="fileUploaded">
                                            <input type="hidden" name="event" value="{{event.name}}">
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                            <button type=submit value="Upload" class="btn btn-primary">Submit</button>
                                        </div>
                                    </form>
                                </div>
                                </div>
                            </div>
                        {% else %}
                            <a href="/users/register_indi_event/{{event.id}}">
                                <li style="cursor: pointer;" class="tag__item play blue"><i class="fas fa-edit mr-2"></i> Register</li>
                            </a>
                        {% endif %}
                    </div>

                </ul>
            </div>
        </article>
        {% endfor %}
</section>

{% endblock %}


{% block scripts %}
<!-- <script src="{% static 'js/main.js' %}"></script> -->
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
{% endblock %}